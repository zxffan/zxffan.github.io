<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="zxffan">


    <meta name="subtitle" content="zxffan's Blog">



    <meta name="keywords" content="zxffan,blog,javascript,nodejs,electron">


<title>HTTP梳理 | zxffan</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 4.2.1"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">ZXFFAN BLOG</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">ZXFFAN BLOG</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">HTTP梳理</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">zxffan</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">十一月 4, 2020&nbsp;&nbsp;
                        <!-- 0:00:00 -->
                        </a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/NetWork/">NetWork</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="HTTP工作模型"><a href="#HTTP工作模型" class="headerlink" title="HTTP工作模型"></a>HTTP工作模型</h2><p>一次HTTP请求涉及到两个角色——<strong>客户端</strong>和<strong>服务端</strong>。</p>
<ol>
<li>客户端发送请求（报文）</li>
<li>服务端收到请求开始处理</li>
<li>然后把响应（报文）发送回客户端</li>
</ol>
<p><img src="../../images/%E5%9B%BE%E8%A7%A3HTTP/http%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%9E%8B.jpg" alt="http工作模型"></p>
<h2 id="持久化连接和管线化"><a href="#持久化连接和管线化" class="headerlink" title="持久化连接和管线化"></a>持久化连接和管线化</h2><h3 id="持久化连接"><a href="#持久化连接" class="headerlink" title="持久化连接"></a>持久化连接</h3><p>传输层的<code>TCP</code>协议，规定通信双方必须<strong>先建立连接</strong>再通信。</p>
<p>在<code>HTTP</code>的初始版本，每进行一次HTTP通信就要断开一次TCP，多个HTTP请求不能复用一个TCP连接</p>
<p>在<code>HTTP1.1</code>中，默认开启持久化连接，是多个HTTP请求可以复用同一个TCP连接。只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。</p>
<p><img src="../../images/%E5%9B%BE%E8%A7%A3HTTP/%E6%8C%81%E4%B9%85%E5%8C%96%E8%BF%9E%E6%8E%A5.jpg" alt="持久化连接"></p>
<h3 id="管线化"><a href="#管线化" class="headerlink" title="管线化"></a>管线化</h3><p>持久连接使得多数请求以管线化（pipelining）方式发送成为可能。从前发送请求后需等待并收到响应，才能发送下一个请求。管线化技术出现后，不用等待响应亦可直接发送下一个请求。</p>
<h2 id="无状态和Cookie"><a href="#无状态和Cookie" class="headerlink" title="无状态和Cookie"></a>无状态和Cookie</h2><h3 id="无状态协议"><a href="#无状态协议" class="headerlink" title="无状态协议"></a>无状态协议</h3><p><code>HTTP</code>协议自身不具备保存之前发送过的请求或响应的功能<br>每当有新的请求发送时，就会有对应的新响应产生。协议本身并不保留之前一切的请求或响应报文的信息。</p>
<p>但是无状态也会导致新的问题——用户登陆状态如何保存？</p>
<p>于是引入了<code>Cookie</code></p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p><code>Cookie</code> 是通过在请求和响应报文中写入 <code>Cookie</code> 信息来控制客户端的状态。</p>
<ol>
<li>客户端发送请求报文</li>
<li>服务端收到请求，处理。在响应报文中添加一个<code>Set-Cookie</code>的首部字段</li>
<li>客户端收到响应，取出<code>Set-Cookie</code>的信息</li>
<li>客户端以后发送的请求，在请求报文首部加上<code>Cookie</code>。这样服务端就能识别客户端了。</li>
</ol>
<h2 id="HTTP-报文"><a href="#HTTP-报文" class="headerlink" title="HTTP 报文"></a>HTTP 报文</h2><p>用于 HTTP 协议交互的信息被称为 HTTP 报文。请求端（客户端）的HTTP 报文叫做<strong>请求报文</strong>，响应端（服务器端）的叫做<strong>响应报文</strong>。HTTP 报文本身是由多行（用 CR+LF 作换行符）数据构成的<strong>字符串文本</strong>。</p>
<p>HTTP报文由<strong>报文首部（header）</strong>和<strong>报文主体（body）</strong>构成，两者以<strong>空行（CR+LF）</strong>分隔</p>
<blockquote>
<p>报文：是 HTTP 通信中的基本单位，由 8 位组字节流（octet sequence，其中 octet 为 8 个比特）组成，通过 HTTP 通信传输。</p>
</blockquote>
<h2 id="提升传输速率"><a href="#提升传输速率" class="headerlink" title="提升传输速率"></a>提升传输速率</h2><h3 id="压缩"><a href="#压缩" class="headerlink" title="压缩"></a>压缩</h3><p><strong>内容编码</strong>保持实体信息原样压缩，内容编码后的实体由客户端接收并负责解码。</p>
<p>常用的内容编码有以下几种。</p>
<ul>
<li>gzip（GNU zip）</li>
<li>compress（UNIX 系统的标准压缩）</li>
<li>deflate（zlib）</li>
<li>identity（不进行编码）</li>
</ul>
<h3 id="分块"><a href="#分块" class="headerlink" title="分块"></a>分块</h3><p><strong>分块传输编码</strong>会将实体主体分成多个部分（块）。<br>使用分块传输编码的实体主体会由接收的客户端负责解码，恢复到编码前的实体主体。</p>
<h2 id="多部分对象集合"><a href="#多部分对象集合" class="headerlink" title="多部分对象集合"></a>多部分对象集合</h2><p><code>HTTP</code>协议发送的报文主体可以包含多个类型实体。<br>多部分对象集合包含的对象如下：</p>
<ul>
<li>multipart/form-data: <code>Content-Type: multipart/form-data; boundary=AaB03x</code></li>
<li>multipart/byteranges: <code>Content-Type: multipart/byteranges; boundary=THIS_STRING_SEPARATES</code></li>
</ul>
<p><code>Content-Type</code>定义资源类型<br><code>boundary</code>定义不同类型实体之间的分隔符</p>
<h2 id="范围请求"><a href="#范围请求" class="headerlink" title="范围请求"></a>范围请求</h2><p>指定范围发送的请求叫做<strong>范围请求</strong><br>byte 范围的指定形式如下。</p>
<ul>
<li>5001~10 000 字节：<code>Range: bytes=5001-10000</code></li>
<li>从 5001 字节之后全部的: <code>Range: bytes=5001-</code></li>
<li>从一开始到 3000 字节和 5000~7000 字节的多重范围: <code>Range: bytes=-3000, 5000-7000</code></li>
</ul>
<p>针对范围请求，响应会返回状态码为 206 Partial Content 的响应报文。另外，对于多重范围的范围请求，响应会在首部字段 Content-Type 标明 multipart/byteranges 后返回响应报文。</p>
<h2 id="内容协商"><a href="#内容协商" class="headerlink" title="内容协商"></a>内容协商</h2><p>内容协商机制是指客户端和服务器端就响应的资源内容进行交涉，然后提供给客户端最为适合的资源。</p>
<p>比如说，客户端浏览器是英文的，服务器返回的网页也会是英文的。</p>
<p>相关首部字段如下：</p>
<ul>
<li><code>Accept</code></li>
<li><code>Accept-Charset</code></li>
<li><code>Accept-Encoding</code></li>
<li><code>Accept-Language</code></li>
<li><code>Content-Language</code></li>
</ul>
<h2 id="HTTP状态码"><a href="#HTTP状态码" class="headerlink" title="HTTP状态码"></a>HTTP状态码</h2><table>
<thead>
<tr>
<th></th>
<th>类别</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>1XX</td>
<td>Informational(信息性状态码)</td>
<td>接收到的请求正在处理</td>
</tr>
<tr>
<td>2XX</td>
<td>Success(成功状态吗)</td>
<td>请求正常处理完毕</td>
</tr>
<tr>
<td>3XX</td>
<td>Redirection(重定向状态吗)</td>
<td>需要进行附加操作已完成请求</td>
</tr>
<tr>
<td>4XX</td>
<td>Client Error(客户端错误状态码)</td>
<td>服务器无法处理请求</td>
</tr>
<tr>
<td>5XX</td>
<td>Server Error(服务器错误状态吗)</td>
<td>服务器处理请求出错</td>
</tr>
</tbody></table>
<h3 id="2XX"><a href="#2XX" class="headerlink" title="2XX"></a>2XX</h3><h4 id="200-OK"><a href="#200-OK" class="headerlink" title="200 OK"></a>200 OK</h4><p>表示客户端发来的请求在服务端被正常处理了</p>
<h4 id="204-No-Content"><a href="#204-No-Content" class="headerlink" title="204 No Content"></a>204 No Content</h4><p>请求处理成功，但是没有资源课返回</p>
<h4 id="206-Partial-Content"><a href="#206-Partial-Content" class="headerlink" title="206 Partial Content"></a>206 Partial Content</h4><p>客户端进行了范围请求，服务器成功执行了这部分请求。<br>响应报文中包含由 Content-Range 指定范围的实体内容。</p>
<h3 id="3XX"><a href="#3XX" class="headerlink" title="3XX"></a>3XX</h3><h4 id="301-Moved-Permanently"><a href="#301-Moved-Permanently" class="headerlink" title="301 Moved Permanently"></a>301 Moved Permanently</h4><p>表示所请求的资源已转移到了新的<code>URI</code></p>
<h4 id="302-Found"><a href="#302-Found" class="headerlink" title="302 Found"></a>302 Found</h4><p>临时重定向，该状态码表示请求的资源已被分配了新的 URI，希望用户（本次）能使用新的 URI 访问。</p>
<p>和 301 Moved Permanently 状态码相似，但 302 状态码代表的资源不是被永久移动，只是临时性质的。换句话说，已移动的资源对应的URI 将来还有可能发生改变。</p>
<h4 id="303-See-Other"><a href="#303-See-Other" class="headerlink" title="303 See Other"></a>303 See Other</h4><p>该状态码表示由于请求对应的资源存在着另一个 URI，应使用 GET方法定向获取请求的资源。</p>
<p>303 状态码和 302 Found 状态码有着相同的功能，但 303 状态码明确表示客户端应当采用 GET 方法获取资源，这点与 302 状态码有区别。</p>
<h4 id="304-Not-Modified"><a href="#304-Not-Modified" class="headerlink" title="304 Not Modified"></a>304 Not Modified</h4><p>服务端返回304，表示资源没有改动。浏览器可以从本地缓存中读取资源。</p>
<h4 id="307-Temporary-Redirect"><a href="#307-Temporary-Redirect" class="headerlink" title="307 Temporary Redirect"></a>307 Temporary Redirect</h4><p>临时重定向。该状态码与 302 Found 有着相同的含义。尽管 302 标准禁止 POST 变换成 GET，但实际使用时大家并不遵守。<br>307 会遵照浏览器标准，不会从 POST 变成 GET。但是，对于处理响应时的行为，每种浏览器有可能出现不同的情况。</p>
<h3 id="4XX"><a href="#4XX" class="headerlink" title="4XX"></a>4XX</h3><h4 id="400-Bad-Request"><a href="#400-Bad-Request" class="headerlink" title="400 Bad Request"></a>400 Bad Request</h4><p>表示请求报文存在错误</p>
<h4 id="401-Unauthorized"><a href="#401-Unauthorized" class="headerlink" title="401 Unauthorized"></a>401 Unauthorized</h4><p>没有通过HTTP认证，当浏览器初次接收到 401 响应，会弹出认证用的对话窗口。</p>
<h4 id="403-Forbidden"><a href="#403-Forbidden" class="headerlink" title="403 Forbidden"></a>403 Forbidden</h4><p>该状态码表明对请求资源的访问被服务器拒绝了</p>
<h4 id="404-Not-Found"><a href="#404-Not-Found" class="headerlink" title="404 Not Found"></a>404 Not Found</h4><p>所请求的资源不存在。</p>
<h3 id="5XX"><a href="#5XX" class="headerlink" title="5XX"></a>5XX</h3><h4 id="500-Internal-Server-Error"><a href="#500-Internal-Server-Error" class="headerlink" title="500 Internal Server Error"></a>500 Internal Server Error</h4><p>该状态码表明服务器端在执行请求时发生了错误</p>
<h4 id="503-Service-Unavailable"><a href="#503-Service-Unavailable" class="headerlink" title="503 Service Unavailable"></a>503 Service Unavailable</h4><p>该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。<br>如果事先得知解除以上状况需要的时间，最好写入RetryAfter 首部字段再返回给客户端。</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>zxffan</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://zxffan.github.io/posts/3b531846.html">https://zxffan.github.io/posts/3b531846.html</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/NetWork/"># NetWork</a>
                    
                        <a href="/tags/HTTP/"># HTTP</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/posts/8b77beaa.html">HTTP首部</a>
            
            
            <a class="next" rel="next" href="/posts/4e5b3a92.html">Web网络基础</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
  <div class="copyright">
    <span>Copyright 2019-2020 © zxffan</span>
  </div>
</footer>

    </div>
</body>
</html>
